{% extends "base_admin.html" %}

{% block content %}
   

    <div class="container">
        <div class="row justify-content-center">
            {% load static %}
            
            <div class="col" style="background-color: #4A4947; color: white;">
                <br>
                
                <div class="card shadow-lg border-0 rounded-lg" style="background-color: #4A4947; color: white;">
                    <div class="card-header bg-dark text-white" style="border-radius: 10px;">
                        <h3 class="text-center font-weight-light my-3">Doctor Registration Form</h3>
                    </div>
                    <img class="col-12" src="{% static 'images/doc2.jpg' %}" alt="" style="width: 40%; margin: 0 auto; display: block; border-radius: 20%;">
                    <br>
                    <div class="card-body" style="background-color: #4A4947; color: white;">
                        <form method="POST">
                            {% csrf_token %}

                            <!-- Username with Auto-suggest -->
                            <div class="form-group mb-3">
                                <label for="username" class="form-label">Username:</label>
                                <input type="text" class="form-control" id="username" name="username" placeholder="Enter doctor's username" autocomplete="off" required>
                                <div id="usernameSuggestions" class="list-group mt-1" style="display: none;"></div>
                            </div>

                            <!-- Designation -->
                            <div class="form-group mb-3">
                                <label for="designation" class="form-label">Designation:</label>
                                <input type="text" class="form-control" id="designation" name="designation" placeholder="Enter doctor's designation" required>
                            </div>

                            <!-- Fee -->
                            <div class="form-group mb-3">
                                <label for="fee" class="form-label">Fee:</label>
                                <input type="number" class="form-control" id="fee" name="fee" placeholder="Enter fee" value="1000" required>
                            </div>

                            <!-- Assistant Selection (Optional) -->
                            

                            <!-- Submit Button -->
                            <div class="d-grid">
                                <button type="submit" class="btn btn-dark btn-block">Register Doctor</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Function to show username suggestions
        document.getElementById('username').addEventListener('input', function() {
            const query = this.value;
            if (query.length > 2) {
                fetch(`/get_usernames/?q=${query}`)
                    .then(response => response.json())
                    .then(data => {
                        const suggestionsBox = document.getElementById('usernameSuggestions');
                        suggestionsBox.innerHTML = '';
                        if (data.length > 0) {
                            suggestionsBox.style.display = 'block';
                            data.forEach(user => {
                                const suggestionItem = document.createElement('div');
                                suggestionItem.classList.add('list-group-item', 'list-group-item-action');
                                suggestionItem.textContent = user.username;
                                suggestionItem.onclick = function() {
                                    document.getElementById('username').value = user.username;
                                    suggestionsBox.style.display = 'none';
                                };
                                suggestionsBox.appendChild(suggestionItem);
                            });
                        } else {
                            suggestionsBox.style.display = 'none';
                        }
                    });
            } else {
                document.getElementById('usernameSuggestions').style.display = 'none';
            }
        });
    </script>
{% endblock content %}
